<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>5wodrs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Georgia:wght@400;700&display=swap" rel="stylesheet">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7313136524968138"
     crossorigin="anonymous"></script>
    <style>
        :root {
            --bg-color: #fdfdfa;
            --text-color: #333;
            --border-color: #d1d5db;
            --key-bg: #e5e7eb;
            --key-text: #333;
            --correct-bg: #6aaa64;
            --present-bg: #c9b458;
            --absent-bg: #787c7e;
        }

        body {
            font-family: 'Georgia', serif;
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        #game-board {
            perspective: 1000px;
        }

        .tile {
            transform-style: preserve-3d;
            /* transition: transform 0.6s; REMOVED to make flip instant */
        }

        .tile.flipped {
            transform: rotateX(180deg);
        }

        .tile .front, .tile .back {
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }

        .tile .back {
            transform: rotateX(180deg);
        }

        .key {
            background-color: var(--key-bg);
            color: var(--key-text);
            transition: background-color 0.2s, transform 0.1s;
        }
        
        .key:active {
            transform: scale(0.95);
        }

        .key:disabled {
            background-color: #d1d5db;
            color: #9ca3af;
        }

        .bg-correct { background-color: var(--correct-bg) !important; border-color: var(--correct-bg) !important; color: white; }
        .bg-present { background-color: var(--present-bg) !important; border-color: var(--present-bg) !important; color: white; }
        .bg-absent { background-color: var(--absent-bg) !important; border-color: var(--absent-bg) !important; color: white; }
        
        .text-correct { color: var(--correct-bg); }
        .text-present { color: var(--present-bg); }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes shake {
            10%, 90% { transform: translateX(-1px); }
            20%, 80% { transform: translateX(2px); }
            30%, 50%, 70% { transform: translateX(-4px); }
            40%, 60% { transform: translateX(4px); }
        }

        .game-over-dim {
            opacity: 0.6;
            pointer-events: none;
        }
        
        .title-glow {
            animation: pulse-glow 4s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0%, 100% {
                text-shadow: 0 0 8px rgba(50, 50, 50, 0.2);
            }
            50% {
                text-shadow: 0 0 16px rgba(50, 50, 50, 0.4);
            }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <!-- Start Screen -->
    <div id="start-screen" class="flex flex-col items-center justify-center text-center">
        <h1 class="text-7xl font-bold text-gray-800 mb-4 title-glow">
            5<span class="text-correct">w</span><span class="text-correct">o</span><span class="text-present">d</span><span class="text-correct">r</span><span class="text-correct">s</span>
        </h1>
        <p class="text-gray-500 mb-10">A classic word puzzle.</p>
        <button id="play-button" class="bg-gray-800 hover:bg-gray-700 text-white font-bold py-3 px-8 rounded-lg text-lg transition-colors duration-300">
            Play
        </button>
        <h2 class="text-2xl font-bold text-gray-700 mt-8 mb-2">How to Play</h2>
        <ul class="text-left text-gray-600 space-y-2 list-disc pl-5">
            <li>Guess the hidden 5-letter word.</li>
            <li>You have 5 attempts to guess it.</li>
            <li>Tile colors show how close you are.</li>
        </ul>
    </div>

    <!-- Game Container -->
    <div id="game-container" class="hidden flex-col items-center justify-between w-full h-full max-w-md mx-auto">
        <header class="w-full text-center border-b border-gray-300 pb-4 mb-6">
            <h1 class="text-4xl font-bold text-gray-800">
                5<span class="text-correct">w</span><span class="text-correct">o</span><span class="text-present">d</span><span class="text-correct">r</span><span class="text-correct">s</span>
            </h1>
            <div class="mt-4 flex justify-center gap-4">
                <button id="hint-button" class="bg-indigo-200 hover:bg-indigo-300 text-indigo-800 font-bold py-2 px-4 rounded-lg text-md transition-colors duration-300">
                    Hint
                </button>
                <button id="reset-button" class="hidden bg-gray-800 hover:bg-gray-700 text-white font-bold py-2 px-6 rounded-lg text-md transition-colors duration-300">
                    Play Again
                </button>
            </div>
        </header>

        <main id="game-board" class="grid grid-rows-5 gap-1.5 mb-6">
            <!-- Game tiles will be generated here -->
        </main>

        <!-- Ad Unit -->
        <div class="my-4">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-7313136524968138"
                 data-ad-slot="3811112218"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
        </div>

        <div id="keyboard" class="w-full mt-4">
            <!-- Keyboard will be generated here -->
        </div>
    </div>
    
    <!-- Toast Notification -->
    <div id="toast" class="fixed top-16 bg-gray-800 text-white font-semibold py-2 px-5 rounded-md shadow-lg opacity-0 transition-opacity duration-300">
        <p id="toast-message"></p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- DOM Elements ---
            const startScreen = document.getElementById('start-screen');
            const gameContainer = document.getElementById('game-container');
            const playButton = document.getElementById('play-button');
            const resetButton = document.getElementById('reset-button');
            const gameBoard = document.getElementById('game-board');
            const keyboardContainer = document.getElementById('keyboard');
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toast-message');
            const hintButton = document.getElementById('hint-button');

            // --- Game State ---
            const WORD_LENGTH = 5;
            const MAX_ATTEMPTS = 5;
            let currentAttempt = 0;
            let currentGuess = Array(WORD_LENGTH).fill('');
            let secretWord = '';
            let wordList = [];
            let isGameOver = false;
            let isProcessing = true;
            let keyState = {};
            let revealedIndices = new Set();
            let lockedIndices = new Set();
            let previousGuesses = [];

            // --- Keyboard Layout ---
            const keys = [
                ['Q', 'W', 'E', 'R', 'T', 'Y', 'U', 'I', 'O', 'P'],
                ['A', 'S', 'D', 'F', 'G', 'H', 'J', 'K', 'L'],
                ['ENTER', 'Z', 'X', 'C', 'V', 'B', 'N', 'M', 'BACK']
            ];

            // --- Helper Functions ---
            const hasUniqueLetters = (word) => new Set(word).size === word.length;

            function setupUI() {
                createGameBoard();
                createKeyboard();
            }

            async function startGame() {
                startScreen.classList.add('hidden');
                gameContainer.classList.remove('hidden');
                gameContainer.classList.add('flex');
                
                // Push the ad only after the container is visible to prevent errors
                try {
                    (adsbygoogle = window.adsbygoogle || []).push({});
                } catch (e) {
                    console.error("AdSense error:", e);
                }

                isProcessing = true;

                if (wordList.length === 0) {
                    showToast("Loading dictionary...", 3000);
                    try {
                        const response = await fetch('https://gist.githubusercontent.com/cfreshman/a03ef2cba789d8cf00c08f767e0fad7b/raw/5d752e5f0702da315298a6bb5a771586d6ff445c/wordle-answers-alphabetical.txt');
                        const text = await response.text();
                        wordList = text.split('\n')
                            .map(w => w.trim().toUpperCase())
                            .filter(w => w.length === WORD_LENGTH && /^[A-Z]+$/.test(w) && hasUniqueLetters(w));
                    } catch (error) {
                        console.error("Failed to load word list:", error);
                        showToast("Could not load dictionary.", 5000);
                        isGameOver = true;
                        isProcessing = false;
                        return;
                    }
                }
                resetGame();
                isProcessing = false;
            }

            function resetGame() {
                currentAttempt = 0;
                currentGuess = Array(WORD_LENGTH).fill('');
                isGameOver = false;
                keyState = {};
                revealedIndices.clear();
                lockedIndices.clear();
                previousGuesses = [];
                
                gameBoard.innerHTML = '';
                createGameBoard();

                Array.from(document.getElementsByClassName('key')).forEach(key => {
                    key.classList.remove('bg-correct', 'bg-present', 'bg-absent');
                });
                
                gameBoard.classList.remove('game-over-dim');
                keyboardContainer.classList.remove('game-over-dim');

                secretWord = wordList[Math.floor(Math.random() * wordList.length)];
                console.log("Secret Word:", secretWord);

                resetButton.classList.add('hidden');
                hintButton.classList.remove('hidden');
                hintButton.disabled = false;
            }

            function createGameBoard() {
                for (let i = 0; i < MAX_ATTEMPTS; i++) {
                    const row = document.createElement('div');
                    row.id = `row-${i}`;
                    row.classList.add('grid', 'grid-cols-5', 'gap-1.5');
                    for (let j = 0; j < WORD_LENGTH; j++) {
                        const tileContainer = document.createElement('div');
                        tileContainer.classList.add('tile', 'w-16', 'h-16');
                        
                        const front = document.createElement('div');
                        front.classList.add('front', 'w-full', 'h-full', 'border-2', 'border-gray-300', 'flex', 'items-center', 'justify-center', 'text-4xl', 'font-bold', 'uppercase');
                        
                        const back = document.createElement('div');
                        back.classList.add('back', 'w-full', 'h-full', 'border-2', 'border-gray-400', 'flex', 'items-center', 'justify-center', 'text-4xl', 'font-bold', 'uppercase');

                        tileContainer.appendChild(front);
                        tileContainer.appendChild(back);
                        row.appendChild(tileContainer);
                    }
                    gameBoard.appendChild(row);
                }
            }

            function createKeyboard() {
                keys.forEach(rowKeys => {
                    const row = document.createElement('div');
                    row.classList.add('flex', 'justify-center', 'gap-1.5', 'my-1.5');
                    rowKeys.forEach(key => {
                        const button = document.createElement('button');
                        button.id = `key-${key}`;
                        button.textContent = key;
                        button.classList.add('key', 'h-14', 'rounded', 'font-bold', 'uppercase', 'text-gray-800');
                        if (key.length > 1) {
                            button.classList.add('px-4', 'text-sm');
                        } else {
                            button.classList.add('flex-1', 'text-lg');
                        }
                        button.addEventListener('click', () => handleKeyPress(key));
                        row.appendChild(button);
                    });
                    keyboardContainer.appendChild(row);
                });
            }

            function handleKeyPress(key) {
                if (isGameOver || isProcessing) return;
                const upperKey = key.toUpperCase();
                if (upperKey === 'ENTER') submitGuess();
                else if (upperKey === 'BACK' || upperKey === 'BACKSPACE') deleteLetter();
                else if (/^[A-Z]$/.test(upperKey)) addLetter(upperKey);
            }
            
            function addLetter(letter) {
                const firstEmptyIndex = currentGuess.findIndex(char => char === '');
                if (firstEmptyIndex !== -1) {
                    currentGuess[firstEmptyIndex] = letter;
                    const tile = gameBoard.children[currentAttempt].children[firstEmptyIndex].querySelector('.front');
                    tile.textContent = letter;
                }
            }

            function deleteLetter() {
                for (let i = WORD_LENGTH - 1; i >= 0; i--) {
                    if (currentGuess[i] !== '' && !lockedIndices.has(i)) {
                        currentGuess[i] = '';
                        const tile = gameBoard.children[currentAttempt].children[i].querySelector('.front');
                        tile.textContent = '';
                        break;
                    }
                }
            }

            function submitGuess() {
                const finalGuessStr = currentGuess.join('');
                if (finalGuessStr.length !== WORD_LENGTH) {
                    showToast("Not enough letters");
                    shakeRow();
                    return;
                }
                if (!hasUniqueLetters(finalGuessStr)) {
                    showToast("No duplicate letters allowed");
                    shakeRow();
                    return;
                }
                if (previousGuesses.includes(finalGuessStr)) {
                    showToast("Word already used");
                    shakeRow();
                    return;
                }
                if (!wordList.includes(finalGuessStr)) {
                    showToast("Not in word list");
                    shakeRow();
                    return;
                }
                
                previousGuesses.push(finalGuessStr);
                isProcessing = true;
                const feedback = evaluateGuess(finalGuessStr, secretWord);
                revealGuess(feedback, finalGuessStr);
            }
            
            function shakeRow() {
                const row = document.getElementById(`row-${currentAttempt}`);
                row.classList.add('shake');
                row.addEventListener('animationend', () => {
                    row.classList.remove('shake');
                }, { once: true });
            }

            function evaluateGuess(guess, target) {
                const feedback = new Array(WORD_LENGTH).fill(null);
                for (let i = 0; i < WORD_LENGTH; i++) {
                    if (guess[i] === target[i]) {
                        feedback[i] = 'correct';
                    } else if (target.includes(guess[i])) {
                        feedback[i] = 'present';
                    } else {
                        feedback[i] = 'absent';
                    }
                }
                return feedback;
            }

            function revealGuess(feedback, guessStr) {
                const row = gameBoard.children[currentAttempt];
                Array.from(row.children).forEach((tileContainer, index) => {
                    const frontTile = tileContainer.querySelector('.front');
                    
                    const status = feedback[index];
                    let statusClass = 'bg-absent';
                    if (status === 'correct') statusClass = 'bg-correct';
                    if (status === 'present') statusClass = 'bg-present';
                    
                    frontTile.classList.add(statusClass);
                    updateKeyboard(guessStr[index], status);
                });
                checkGameOver(guessStr);
            }
            
            function updateKeyboard(letter, status) {
                const keyButton = document.getElementById(`key-${letter}`);
                const currentStatus = keyState[letter];
                if (currentStatus === 'correct' || (currentStatus === 'present' && status !== 'correct')) return;
                keyState[letter] = status;
                let statusClass = 'bg-absent';
                if (status === 'correct') statusClass = 'bg-correct';
                if (status === 'present') statusClass = 'bg-present';
                keyButton.classList.add(statusClass);
            }

            function checkGameOver(guessStr) {
                lockedIndices.clear(); 
                if (guessStr === secretWord) {
                    const attemptCount = currentAttempt + 1;
                    showToast(`Woohoo! You guessed it in ${attemptCount} attempts!`, 3000);
                    isGameOver = true;
                } else if (currentAttempt >= MAX_ATTEMPTS - 1) {
                    showToast(`The word was: ${secretWord}`, 3000);
                    isGameOver = true;
                } else {
                    currentAttempt++;
                    currentGuess = Array(WORD_LENGTH).fill('');
                    isProcessing = false;
                    hintButton.disabled = false;
                    return;
                }
                gameBoard.classList.add('game-over-dim');
                keyboardContainer.classList.add('game-over-dim');
                resetButton.classList.remove('hidden');
                hintButton.disabled = true;
            }

            function handleHint() {
                if (isGameOver || isProcessing || hintButton.disabled) return;

                const unrevealedCorrectIndices = [];
                for (let i = 0; i < WORD_LENGTH; i++) {
                    if (!revealedIndices.has(i)) {
                        unrevealedCorrectIndices.push(i);
                    }
                }

                if (unrevealedCorrectIndices.length === 0) {
                    showToast("No more hints available.");
                    hintButton.disabled = true;
                    return;
                }

                const randomIndex = unrevealedCorrectIndices[Math.floor(Math.random() * unrevealedCorrectIndices.length)];
                
                if (currentGuess[randomIndex] !== '') {
                    showToast("Hint position already filled. Clear it to get a hint.");
                    return;
                }

                revealedIndices.add(randomIndex);
                lockedIndices.add(randomIndex);

                const letter = secretWord[randomIndex];
                currentGuess[randomIndex] = letter;
                
                const tile = gameBoard.children[currentAttempt].children[randomIndex].querySelector('.front');
                tile.textContent = letter;
                
                showToast("Hint: Revealed a letter!", 1500);
                hintButton.disabled = true;
            }
            
            function showToast(message, duration = 1500) {
                toastMessage.textContent = message;
                toast.classList.remove('opacity-0');
                setTimeout(() => { toast.classList.add('opacity-0'); }, duration);
            }

            // --- Event Listeners ---
            document.addEventListener('keydown', (e) => handleKeyPress(e.key));
            playButton.addEventListener('click', startGame);
            resetButton.addEventListener('click', startGame);
            hintButton.addEventListener('click', handleHint);

            // --- Initial UI Setup ---
            setupUI();
        });
    </script>
</body>
</html>
